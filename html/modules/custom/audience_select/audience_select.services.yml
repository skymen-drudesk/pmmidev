services:
  audience_select.crawler_detect:
    class: Drupal\audience_select\Service\CrawlerDetect
    arguments: ['@request_stack']

  audience_select.audience_manager:
    class: Drupal\audience_select\Service\AudienceManager
    arguments: ['@audience_select.crawler_detect']

  audience_select.audience_select_subscriber:
    class: Drupal\audience_select\EventSubscriber\AudienceSelectSubscriber
    arguments: ['@audience_select.audience_manager', '@path.alias_manager', '@path.matcher']
    tags:
      - { name: event_subscriber }

  cache_context.audience:
    class: Drupal\audience_select\Cache\Context\AudienceCacheContext
    arguments: ['@request_stack', '@audience_select.audience_manager']
    tags:
      - { name: cache.context }

#parameters:
#  renderer.config:
#    # Renderer required cache contexts:
#    #
#    # The Renderer will automatically associate these cache contexts with every
#    # render array, hence varying every render array by these cache contexts.
#    #
#    # @default ['languages:language_interface', 'theme', 'user.permissions']
#    required_cache_contexts: ['languages:language_interface', 'theme', 'user.permissions', 'audience']
#


#  audience_select.current_audience_context:
#    class: Drupal\audience_select\ContextProvider\CurrentAudienceContext
#    arguments: ['@audience_select.audience_manager']
#    tags:
#      - { name: 'context_provider' }

#  page_manager.current_user_context:
#    class: Drupal\page_manager\EventSubscriber\CurrentUserContext
#    arguments: ['@current_user', '@entity_type.manager']
#    tags:
#      - { name: 'event_subscriber' }



#parameters:
#  renderer.config:
#    # Renderer required cache contexts:
#    #
#    # The Renderer will automatically associate these cache contexts with every
#    # render array, hence varying every render array by these cache contexts.
#    #
#    # @default ['languages:language_interface', 'theme', 'user.permissions']
#    required_cache_contexts: ['languages:language_interface', 'theme', 'user.permissions', 'route']
#    # Renderer automatic placeholdering conditions:
#    #
#    # Drupal allows portions of the page to be automatically deferred when
#    # rendering to improve cache performance. That is especially helpful for
#    # cache contexts that vary widely, such as the active user. On some sites
#    # those may be different, however, such as sites with only a handful of
#    # users. If you know what the high-cardinality cache contexts are for your
#    # site, specify those here. If you're not sure, the defaults are fairly safe
#    # in general.
#    #
#    # For more information about rendering optimizations see
#    # https://www.drupal.org/developing/api/8/render/arrays/cacheability#optimizing
#    auto_placeholder_conditions:
#      # Max-age at or below which caching is not considered worthwhile.
#      #
#      # Disable by setting to -1.
#      #
#      # @default 0
#      max-age: 0
#      # Cache contexts with a high cardinality.
#      #
#      # Disable by setting to [].
#      #
#      # @default ['session', 'user']
#      contexts: ['session', 'user', 'cookies']
